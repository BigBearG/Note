#### 操作系统的目标和作用
1.1操作系统的目标:方便性,有效性,可扩充性和开放性
>方便性:使计算机变得简单易用
有效性:提高系统吞吐量,缩短程序运行周期
可扩充性:方便进行添加新的模块和功能
开方性:凡是遵守标准开发的硬件和软件,都能彼此兼容

1.2操作系统的作用
>1.OS作为用户与计算机硬件系统之间的接口
2.OS作为计算机系统资源的管理者
3.OS实现了对计算机资源的抽象(忽略)

1.3推动操作系统发展的主要动力
>1.不断提高计算机资源利用率
2.方便用户
3.器件(硬件)的不断更新换代(每隔18个月硬件就会翻一番)
4.计算机体系结构得到不断发展
5.不断提出新的应用要求

___
### 操作系统发展过程
1.1未配置操作系统的计算机系统
>人工操作方式:
特点:用户独占机器;CPU等待人工操作
脱机输入输出方式
特点:减少了CPU的等待时间;提高了I/O的速度

1.2单道批处理系统
>特点:内存始终保留一个作业,意图解决人机矛盾但是对系统资源浪费

1.3多道批处理系统
>特点:资源利用率高;系统吞吐量大;平均运转周期长;无交互能力
面临的问题:处理机争用问题;内存分配和保护问题;I/O分配问题;文件的组织和管理问题;作业管理问题;用户与系统的接口问题.


1.4分时系统
>特点:多路性；独立性；计时性；交互性；
采用轮转运行的方式，及时接受，及时处理。

1.5实时系统
>重点在于实时，开始戒指时间和完成截止时间的完成任务的情况
特点:多路性；独立性；及时性，交互性；可靠性

___
### 微机操作系统发展过程
1.单用户单任务操作系统
>1.1 CP/M 1974年 Intel 8080出现后的第二年Digital Research 公司开发出了带有软盘8位微机操作系统
>1.2 MS-DOS 1981年 IBM-PC个人计算机(16位) 采用了微软开发的MS-DOS系统

2.单用户多任务操作系统
>1985 Windows 1.0 16
1987 Windows2.0 16
1990 Windows 3.0 32
1995 Windows95 32 支持网络
1998 Windows98 32 最后一个兼容16位 支持多媒体
2001 Windows XP

3.多用户多任务操作系统
>允许多个用户通过各自的终端使用同一台机器,共享主机系统中的资源
UNIX OS 32 BELL实验室 1969~1970
Solaris OS SUN公司 1982
Linux OS  最初芬兰学生Linus Torvalds 80386


___
### 操作系统的基本特性
##### 1.并行与并发
>并行:指两个或多个同一事件在同一时刻发生
并发:指两个或多个事件在同一时间间隔内发生
##### 2.共享
>共享:在OS环境下的共享或资源复用,是指系统中的资源可供内存中多个并发执行的进程交互使用.
互斥共享:对于这种在一段时间内只允许一个访问的资源称为临界资源,而对这种临界资源的访问的共享方式称为互斥共享
同时共享:对于这种在一段时间内有多个进程同时进行访问(宏观)::磁盘
##### 3.虚拟(virtual)
>通过某种技术将一个物理实体变成若干个逻辑上的对应物
时分复用技术:虚拟处理机技术;虚拟设备技术.
空分复用技术:利用存储器的空闲空间分区域运行和存放多道程序
##### 4.异步(Asynchronism)
>在多道程序环境下,系统允许多个进程并发进行,但由于资源的限制,程序通常不能一气呵成的完成,而是采取了停停走走的方式,或者说,进程是以人们不可预料的方式向前推进,即进程的异步性.

___
### 操作系统的主要功能
##### 1.处理机管理功能
>进程控制;进程同步;进程通信;调度(作业掉队,进程调度);
##### 2.存储器管理功能
>内存分配;内存保护;地址映射;内存扩充;
##### 3.设备管理功能
>缓冲管理;设备分配;设备处理
##### 4.文件管理功能
>文件存储空间的管理;目录管理;文件读写管理和保护
##### 5.操作系统与用户之间的接口
>用户接口(联机用户接口,脱机用户接口,图形用户接口);
##### 6.现代操作系统新功能
>系统安全;网络的功能和服务;支持多媒体
____
## OS结构设计
>无结构操作系统;模块化结构OS(内聚高,低耦合);分层式结构OS
____
## 客户/服务器模式(Client/Server Model)
>优点;数据的分布处理和存储;便于集中管理;灵活性和可扩充性;易于改编应用软件
___
## 面向对象的程序设计(Object-Oriental Programing)
>对象,继承,多态,重载
___
## 微内核OS结构
##### 1.基本概念
>足够小的内核;基于客户/服务器模式;应用机制和策略分离原理;采用面向对象技术.
##### 2.基本功能
>进程管理;第几存储管理;中断和陷入处理
##### 3.优点
>提高了系统的可扩展性;增强了系统的可靠性;可移植性强;提供了对分布式系统的支持,融入了面向对象技术.(多次上下文切换,缺点)

___

## 前驱图和程序执行
##### 1.前驱图
>前驱图:指一个有向无循环图DAG(Direceted Acyclic Graph)用于描述程序之间执行的先后顺序.
##### 2.程序顺序执行
>通常:一个应用程序由若干个程序组成,执行时,需要按照某种先后次序顺序执行
特点:顺序性;封闭性;可再现性
##### 3.程序的并发执行
>多个程序在一定的时间间隔内的执行
特征:间断性;失去封闭性;不可再现性
___
## 进程的描述
##### 1.进程的定义和特征
+ 定义:
    + 为了使参与并发执行的每个程序(含数据)都独立运行,在操作系统中必须为之配置一个专门数据结构称为进程
    + 进程是程序的一次执行
    + 进程是一个程序及其数据在处理机上顺序执行时所发生的活动
    + 进程是具有独立功能的程序在一个数据集合上运行的过程,它是系统进行资源分配和调度的一个单位
    + 在引入了进程实体概念后,进程是进程实体运行过程,是系统进行资源分配和调度的一个独立单位

##### 2.进程的特征
+ 动态性 表现在:由创建而生,调度而执行,撤销而消亡
+ 并发性 表现在:多个进程实体同在内存中,在一段时间内运行
+ 独立性 表现在:进程实体是一个能独立运行,独立获得资源和独立接受调度的基本单位
+ 异步性 表现在:不受控制速度向前运行
##### 3.进程基本状态和转换
+ 进程的基本状态:
    + 就绪状态
    + 执行状态
    + 阻塞状态
+ 三种基本状态的转换

![image](https://github.com/BigBearG/Note/blob/master/images/jc_1.jpg)
    
##### 4.创建状态和禁止状态
+ 创建状态
+ 终止状态

![image](https://github.com/BigBearG/Note/blob/master/images/jc_2.jpg)

##### 5.挂起操作和进程状态的转换
![image](https://github.com/BigBearG/Note/blob/master/images/jc_3.jpg)

##### 6.进程管理中的数据结构
+ 内存表
+ 设备表
+ 文件表
+ 进程表 用于进程管理 进程管理控制块PCB
    + PCB:进程控制块(Process Control Block)作为进程实体的一部分,记录了操作系统所需的,用于描述进程当前情况以及管理进程的全部信息,是操作系统中最重要的数据结构.
    + 作用:作为基本运行单位的标志;能实现间断性运行方式;提供进程管理所需要的信息;提供进程调度所需要的信息;实现与其他进程的同步与通信.
    + PCB的信息:
        + 进程标志符:用于唯一的标志一个进程;外部标志符,方便用户访问;内部标志符,方便系统对进程的使用.
        + 处理机状态:由各种寄存器内容构成;通用寄存器,指令计数器,程序状态字PSW,用户栈指针.
        + 进程调度信息:进程状态;进程优先级;进程调度所需的其他信息;事件;
        + 进程控制信息:程序和数据的地址;进程同步和信号量机制;资源清单;链接指针
    + PCB的组织方式:线性方式,线性表;链接方式,队列;索引方式,索引表;
    
_____
## 进程控制
###### 1.操作系统内核
+ 支撑功能:中断管理;时钟管理;原语操作;
+ 资源管理:进程管理;存储器管理;设备管理;
###### 2.进程的创建
+ 进程的层次结构:UNIX中进程创建进程共同组成了一个进程家族,Windows中不存在任何层次结构,而是获得句柄与否,控制与被控制的简单关系.
+ 进程图:为了描述一个进程的家族关系而引入了进程图的概念(Process Graph),树形结构,仅有一root节点.
+ 引起创建进程的事件:用户登录;作业调度;提供服务;应用请求;
= 进程创建(Creation of Process):申请空白PCB;分配所需要的资源;初始化PCB;如果进程就绪队列能接纳新进程,插入就绪队列
###### 3.进程的终止
+ 引起进程终止(Termination of Process)的事件:正常结束;异常结束;外界干预.
+ 进程的终止过程:根据被终止进程的标志符,从PCB集合中检索出来查询状态;若处于执行状态,立即终止执行,置调度标志为真;若进程还有子孙进程,所有进程终止;将被终止进程所拥有的全部资源或者归还其父进程,或者归还给系统;将被终止进程的PCB从所在队列(链表)中移出.
###### 4.进程的阻塞与唤醒
+ 引起进程阻塞和唤醒的事件:向系统请求共享资源失败;等待某种操作的完成;新数据尚未到达;等待新任务的到达;
+ 进程的阻塞过程:在执行的过程中,发生了上述事件,计算机调用阻塞原语block;将该进程停止运行,改变PCB的状态为阻塞,将进程插入阻塞队列
+ 进程的唤醒过程;当被阻塞的进程期待的事件已经发生,由有关进程调用唤醒原语wakeup;先将进程从阻塞队列取出,PCB状态改为就绪,将PCB插入就绪队列
###### 5.进程的挂起与激活
+ 进程的挂起:当系统中出现了进程挂起的事件,OS调用挂起原语suspend将进程挂起;首先检查进程的状态,活动就绪改为静止就绪,活动阻塞改为静止阻塞;
+ 进程的激活:当系统中出现了激活进程的事件,OS调用激活原语active将进程激活;将进程从外存调入内存,检查进程状态,静止就绪改为活动就绪,静止阻塞改为活动阻塞
____
## 进程同步
###### 1.进程同步基本概念
+ 两种形式的制约关系:
    + 间接相互制约关系:互斥,相互竞争使用独占性资源
    + 直接相互制约关系:同步,之间相互合作导致的等待
+ 临界资源(Critical Resouce):许多硬件资源如打印机,属于临界资源,诸进程之间应采用互斥的方式,实现对这种资源的共享
+ 临界区(Critical section):每个进程中访问临界资源的那段代码称为临界区
+ 同步机制遵循的规则:空闲让进;忙则等待;有限等待;让权等待
###### 2.硬件同步机制
+ 关中断:是实现互斥的最简单的方法,最底层的方法;缺点:滥用关中断可能出现严重后果;关中断时间过长,影响系统效率;关中断不适用于多CPU系统
+ Test-and-Set指令:测试并建立指令TS,就像一把block
##### 3.信号量机制
+ 整型信号量:是一个用来表示资源数目和事件发生次数的整型量,除初始化外只能通过两个标准的原子操作(Atomic Operation)wait(S)和signal(S)来访问;又被称为P,V
+ 信号量集:一次可以操作多个信号量,并且为每个信号量指定下限值和操作值的集合
##### 4.管程机制
+ 定义:代表共享资源的数据结构以及对改共享数据的一组过程所组成的管理程序共同构成了一个操作系统的资源管理模块.由名称,局部于管程的共享数据结构说明,对该数据结构进行操作的一组过程,对局部于管程的共享数据设置初始值的语句
+ 条件变量:有时进程需要判断资源条件满足

____
## 进程通信
##### 进程通讯的类型 
+ 共享存储器系统(Shared-Memory System):
    + 基于共享数据结构的通信方式:效率低下,属于低级通信
    + 基于共享存储区的通信方式:不同的进程中的虚拟地址未必一样;共享存储区的访问由进程保持互斥
+ 管道(pipe)通信系统:无名管道只能实现具有亲缘关系的传递
+ 消息传递系统(Message passing system):直接通信;间接通信
+ 客户机-服务器(Client-Server client):套接字(Socket);基于tcp/ip协议的http

____
## 线程(Threads)的基本概念
##### 1.线程的引入
+ 属性:进程是一个可拥有资源的独立单位;进程是一个独立调度和分配的基本单位
+ 程序并发执行所需付出的时空开销:创建进程;撤销进程;进程切换;
+ 线程:作为调度和分配的基本单位
##### 2.线程与进程比较
+ 调度的基本单位:进程作为独立调度和分配的基本单位;引入线程OS中,线程作为独立运行的基本单位,在同一进程中,线程的切换不会引起进程的切换,不同进程中的线程切换,引起进程的切换
+ 并发性:引入线程的OS中,进程可以并发执行,线程可以并发执行,一个进程中的全部线程可以并发执行
+ 拥有资源:进程可以拥有资源,并且作为系统中的基本单位;线程本身不拥有系统资源,仅有一点必不可少的能保持运行的资源
+ 独立性: 线程的独立性差
+ 系统开销:线程消耗资源少
+ 支持多处理机系统:多线程
##### 3.线程的状态和线程控制块
+ 线程运行的三个状态:执行,就绪,阻塞
+ 线程控制块(TCB):线程标志符,一组寄存器,线程的运行状态,优先级,线程专有存储区,信号屏蔽,堆栈指针
+ 多线程OS中的进程属性:进程是一个可拥有资源的基本单位;多个线程可并发执行;进程已不是可执行的实体
 ____
## 线程的实现
##### 1.线程的实现方式
+ 内核支持线程KST(Kernel Supported Threads):创建,阻塞,撤销和切换都是在内核空间实现的;优点:内核可以调度同一进程的多个线程并发执行;如果进程中一个线程阻塞,可以运行其他线程;线程的切换比较快,开销小;提高操作系统的执行速度和效率
+ 用户级线程ULT(User Level Threads):线程的创建,撤销,同步及通信,无需内核支持,内湖不知道用户级线程的存在;优点:切换不需要到内核空间;调度算法可以进程专用;线程实现与内核无关

